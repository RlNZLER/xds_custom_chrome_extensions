<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>pcoc-click-template</title>
    <style>
      :root{
        --bg: #0b0f1a;
        --card:#0f1629;
        --muted:#8b9ac0;
        --text:#e6eeff;
        --brand:#5b93ff;
        --brand-2:#8b5bff;
        --ok:#10b981;
        --warn:#f59e0b;
        --err:#ef4444;
        --ring: rgba(91,147,255,.45);
      }
      @media (prefers-color-scheme: light){
        :root{
          --bg:#f7f8fc; --card:#ffffff; --text:#0b0f1a; --muted:#5b6478;
          --brand:#4169ff; --brand-2:#7a5cff; --ring: rgba(65,105,255,.25);
      }}
      *{box-sizing:border-box}
      html,body{margin:0}
      body{
        background: radial-gradient(1200px 600px at 20% -10%, rgba(91,147,255,.18), transparent 60%),
                    radial-gradient(900px 500px at 120% 10%, rgba(139,91,255,.18), transparent 60%), var(--bg);
        color:var(--text); font: 14px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
        padding:14px; width:400px;
      }
      .card{
        background:linear-gradient(180deg, color-mix(in srgb, var(--card) 96%, #fff 4%), var(--card));
        border:1px solid color-mix(in srgb, var(--card) 85%, #fff 15%);
        border-radius:16px; padding:14px; box-shadow: 0 10px 30px rgba(0,0,0,.12);
      }
      .row{display:flex; align-items:center; gap:10px; justify-content:space-between}
      .title{
        display:flex; align-items:center; gap:8px; font-weight:700; letter-spacing:.2px;
      }
      .title .logo{
        width:26px; height:26px; display:grid; place-items:center;
        border-radius:10px; background:linear-gradient(135deg,var(--brand),var(--brand-2));
        box-shadow: 0 6px 18px var(--ring);
      }
      .muted{color:var(--muted)}
      button{
        appearance:none; border:0; border-radius:12px; padding:10px 14px; font-weight:600;
        color:#fff; cursor:pointer;
        background:linear-gradient(135deg,var(--brand),var(--brand-2));
        box-shadow: 0 10px 24px var(--ring); transition: transform .08s ease, box-shadow .2s ease, opacity .2s ease;
      }
      button:hover{ transform: translateY(-1px); box-shadow:0 14px 28px var(--ring) }
      button:disabled{ opacity:.6; cursor:not-allowed; transform:none; box-shadow:none }
      #status{
        margin:10px 0 2px; font-size:12px; display:flex; align-items:center; gap:8px;
      }
      .dot{width:8px; height:8px; border-radius:999px; background:var(--muted)}
      .ok .dot{ background:var(--ok) } .warn .dot{ background:var(--warn) } .err .dot{ background:var(--err) }
      .hint .dot{ background:var(--brand) }
      .progress{
        display:none; margin:8px 0 2px; height:10px; border-radius:999px; overflow:hidden;
        background: color-mix(in srgb, var(--card) 80%, #fff 20%); border:1px solid color-mix(in srgb, var(--card) 70%, #fff 30%);
      }
      .bar{ height:100%; width:0%; background:linear-gradient(90deg,var(--brand),var(--brand-2)); transition:width .25s ease }
      .progress-meta{ display:none; font-size:12px; color:var(--muted); margin:6px 0 0 }
      pre{
        margin-top:10px; border-radius:12px; padding:10px;
        background: color-mix(in srgb, var(--card) 92%, #000 8%);
        border:1px solid color-mix(in srgb, var(--card) 80%, #fff 20%);
        max-height:260px; overflow:auto; font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:12px;
      }
      .footer{
        margin-top:10px; display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:12px;
      }
      .pill{
        padding:6px 10px; border-radius:999px; background: color-mix(in srgb, var(--card) 85%, #fff 15%);
        border:1px solid color-mix(in srgb, var(--card) 75%, #fff 25%);
      }
    </style>
  </head>
  <body>
    <div class="card">
      <div class="row">
        <div class="title">
          <div class="logo">âš¡</div>
          <div>
            pcoc-click-template
            <div class="muted" style="font-weight:500; font-size:12px">SABER request collector</div>
          </div>
        </div>
        <button id="collectBtn" title="Collect & Export">Collect</button>
      </div>

      <div id="status" class="hint"><span class="dot"></span><span id="statusText">Ready</span></div>

      <div id="progressWrap" class="progress"><div id="progressBar" class="bar"></div></div>
      <div id="progressMeta" class="progress-meta">0 / 0 pages</div>

      <!-- <pre id="output">{}</pre> -->

      <div class="footer">
        <span class="pill">Exports to Excel</span>
        <span class="muted">Formatting preserved</span>
      </div>
    </div>

    <!-- libs first -->
    <script src="lib/xlsx-populate.min.js"></script>
    <script src="popup.js"></script>
  </body>
</html>
